{"ast":null,"code":"import{Routes,Route,useNavigate}from'react-router-dom';import React,{Fragment,useState,useEffect}from'react';import{Dialog,Disclosure,Menu,Transition}from'@headlessui/react';import{XMarkIcon}from'@heroicons/react/24/outline';import Cookies from'js-cookie';import Skeleton from'react-loading-skeleton';import'react-loading-skeleton/dist/skeleton.css';import CategoryTabs from'./categoryTabs.jsx';import Products from'./products.jsx';import Filters from'../components/ecommerce/components/category-filters/with_inline_actions_and_expandable_sidebar_filters.jsx';import Cards from'./Cards.jsx';import Footer from'../components/marketing/sections/footers/4_column_with_company_mission.jsx';import Header from'./header/index.jsx';import{jsx as _jsx}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function HomePage(){const[products,setProducts]=useState(null);const[loading,setLoading]=useState(true);const[subCategories,setCategories]=useState(null);const[tabs,setTabs]=useState([]);const searchParams=new URLSearchParams(window.location.search);const rawData=searchParams.get('data');const decodedData=JSON.parse(decodeURIComponent(rawData));const[currentCategoryId,setCurrentCategoryId]=useState(null);const navigate=useNavigate();useEffect(()=>{const apiUrl=\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/categories/\");fetch(apiUrl).then(response=>{if(!response.ok){throw new Error('Сетевая ошибка');}return response.json();}).then(data=>{setCategories(data);}).catch(error=>{console.error('!!! Ошибка',error);});},[]);useEffect(()=>{if(subCategories){const categoryTabs=subCategories.map(category=>({id:category.id,name:category.name,onClick:()=>handleCategoryClick(category.id),current:category.id===currentCategoryId}));setTabs(categoryTabs);}},[subCategories,currentCategoryId]);// Updated handleCategoryClick\nconst handleCategoryClick=categoryId=>{const category_id=categoryId!=null?categoryId:'';// If categoryId is null, use an empty string\nnavigate(\"/products?data=\".concat(encodeURIComponent(JSON.stringify({category_id}))));fetchProducts(categoryId);setCurrentCategoryId(categoryId);};// Updated fetchProducts\nconst fetchProducts=categoryId=>{const apiUrl=categoryId?\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/products/?category_id=\").concat(categoryId):process.env.REACT_APP_API_BASE_URL+'/api/products/';fetch(apiUrl).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}return response.json();}).then(data=>{setProducts(data.results);setLoading(false);}).catch(error=>{console.error('Error fetching product:',error);setLoading(false);});};useEffect(()=>{const apiUrl=decodedData!=null?decodedData.category_id?\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/products/?category_id=\").concat(decodedData.category_id):\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/api/products/?category_id=\").concat(decodedData.parent_category_id):process.env.REACT_APP_API_BASE_URL+'/api/products/';fetch(apiUrl).then(response=>{if(!response.ok){throw new Error('Network response was not ok');}return response.json();}).then(data=>{setProducts(data);setLoading(false);}).catch(error=>{console.error('Error fetching product:',error);setLoading(false);});},[window.location.search]);return/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Header,{}),/*#__PURE__*/_jsx(Routes,{children:/*#__PURE__*/_jsx(Route,{element:/*#__PURE__*/_jsx(Filters,{}),children:/*#__PURE__*/_jsx(Route,{index:true,element:[/*#__PURE__*/_jsx(CategoryTabs,{decodedData:decodedData,tabs:tabs}),/*#__PURE__*/_jsx(Products,{products:products})]})})}),/*#__PURE__*/_jsx(Footer,{})]});}","map":{"version":3,"names":["Routes","Route","useNavigate","React","Fragment","useState","useEffect","Dialog","Disclosure","Menu","Transition","XMarkIcon","Cookies","Skeleton","CategoryTabs","Products","Filters","Cards","Footer","Header","jsx","_jsx","_Fragment","jsxs","_jsxs","HomePage","products","setProducts","loading","setLoading","subCategories","setCategories","tabs","setTabs","searchParams","URLSearchParams","window","location","search","rawData","get","decodedData","JSON","parse","decodeURIComponent","currentCategoryId","setCurrentCategoryId","navigate","apiUrl","concat","process","env","REACT_APP_API_BASE_URL","fetch","then","response","ok","Error","json","data","catch","error","console","categoryTabs","map","category","id","name","onClick","handleCategoryClick","current","categoryId","category_id","encodeURIComponent","stringify","fetchProducts","results","parent_category_id","children","element","index"],"sources":["/Users/muhammadkamolov/Downloads/knox_mkp/kiwy_01/src/pages/search.jsx"],"sourcesContent":["import { Routes, Route, useNavigate } from 'react-router-dom';\r\nimport React, {Fragment, useState, useEffect} from 'react'\r\nimport {Dialog, Disclosure, Menu, Transition} from '@headlessui/react'\r\nimport {XMarkIcon} from '@heroicons/react/24/outline'\r\nimport Cookies from 'js-cookie';\r\nimport Skeleton from 'react-loading-skeleton'\r\nimport 'react-loading-skeleton/dist/skeleton.css'\r\nimport CategoryTabs from './categoryTabs.jsx'\r\nimport Products from './products.jsx'\r\n\r\n\r\n\r\nimport Filters from '../components/ecommerce/components/category-filters/with_inline_actions_and_expandable_sidebar_filters.jsx';\r\nimport Cards from './Cards.jsx';\r\nimport Footer from '../components/marketing/sections/footers/4_column_with_company_mission.jsx';\r\nimport Header from './header/index.jsx'\r\n\r\nexport default function HomePage() {\r\n  const [products, setProducts] = useState(null);\r\n  const [loading, setLoading] = useState(true);\r\n  const [subCategories, setCategories] = useState(null);\r\n  const [tabs, setTabs] = useState([]);\r\n\r\n  const searchParams = new URLSearchParams(window.location.search);\r\n  const rawData = searchParams.get('data');\r\n  const decodedData = JSON.parse(decodeURIComponent(rawData));\r\n\r\n  const [currentCategoryId, setCurrentCategoryId] = useState(null);\r\n  const navigate = useNavigate();\r\n\r\n  useEffect(() => {\r\n      const apiUrl = `${process.env.REACT_APP_API_BASE_URL}/api/categories/`;\r\n\r\n      fetch(apiUrl)\r\n          .then((response) => {\r\n              if (!response.ok) {\r\n                  throw new Error('Сетевая ошибка');\r\n              }\r\n              return response.json();\r\n          })\r\n          .then((data) => {\r\n              setCategories(data);\r\n          })\r\n          .catch((error) => {\r\n              console.error('!!! Ошибка', error);\r\n          });\r\n  }, []);\r\n\r\n  useEffect(() => {\r\n      if (subCategories) {\r\n          const categoryTabs = subCategories.map((category) => ({\r\n              id: category.id,\r\n              name: category.name,\r\n              onClick: () => handleCategoryClick(category.id),\r\n              current: category.id === currentCategoryId,\r\n          }));\r\n          setTabs(categoryTabs);\r\n      }\r\n  }, [subCategories, currentCategoryId]);\r\n\r\n  \r\n  // Updated handleCategoryClick\r\n  const handleCategoryClick = (categoryId) => {\r\n      const category_id = categoryId != null ? categoryId : ''; // If categoryId is null, use an empty string\r\n      navigate(`/products?data=${encodeURIComponent(JSON.stringify({ category_id }))}`);\r\n      fetchProducts(categoryId);\r\n      setCurrentCategoryId(categoryId);\r\n  };\r\n\r\n// Updated fetchProducts\r\nconst fetchProducts = (categoryId) => {\r\nconst apiUrl = categoryId\r\n  ? `${process.env.REACT_APP_API_BASE_URL}/api/products/?category_id=${categoryId}`\r\n  : process.env.REACT_APP_API_BASE_URL + '/api/products/';\r\n\r\nfetch(apiUrl)\r\n  .then((response) => {\r\n      if (!response.ok) {\r\n          throw new Error('Network response was not ok');\r\n      }\r\n      return response.json();\r\n  })\r\n  .then((data) => {\r\n      setProducts(data.results);\r\n      setLoading(false);\r\n  })\r\n  .catch((error) => {\r\n      console.error('Error fetching product:', error);\r\n      setLoading(false);\r\n  });\r\n};\r\n\r\n\r\n  useEffect(() => {\r\n    const apiUrl = decodedData != null\r\n    ? \r\n      decodedData.category_id ? `${process.env.REACT_APP_API_BASE_URL}/api/products/?category_id=${decodedData.category_id}`\r\n      : `${process.env.REACT_APP_API_BASE_URL}/api/products/?category_id=${decodedData.parent_category_id}`\r\n        : process.env.REACT_APP_API_BASE_URL + '/api/products/';\r\n  \r\n  \r\n    fetch(apiUrl)\r\n        .then((response) => {\r\n            if (!response.ok) {\r\n                throw new Error('Network response was not ok');\r\n            }\r\n            return response.json();\r\n        })\r\n        .then((data) => {\r\n            setProducts(data);\r\n            setLoading(false);\r\n        })\r\n        .catch((error) => {\r\n            console.error('Error fetching product:', error);\r\n            setLoading(false);\r\n        });\r\n  }, [window.location.search]);\r\n  return (\r\n    <>\r\n    \r\n    <Header />\r\n    <Routes>\r\n        <Route element={<Filters />} >\r\n          <Route index element={[\r\n            <CategoryTabs decodedData={decodedData} tabs={tabs}/>,\r\n            <Products products={products} />]\r\n          }/>\r\n        </Route >\r\n    </Routes>\r\n    <Footer />\r\n\r\n    </>\r\n  );\r\n}\r\n"],"mappings":"AAAA,OAASA,MAAM,CAAEC,KAAK,CAAEC,WAAW,KAAQ,kBAAkB,CAC7D,MAAO,CAAAC,KAAK,EAAGC,QAAQ,CAAEC,QAAQ,CAAEC,SAAS,KAAO,OAAO,CAC1D,OAAQC,MAAM,CAAEC,UAAU,CAAEC,IAAI,CAAEC,UAAU,KAAO,mBAAmB,CACtE,OAAQC,SAAS,KAAO,6BAA6B,CACrD,MAAO,CAAAC,OAAO,KAAM,WAAW,CAC/B,MAAO,CAAAC,QAAQ,KAAM,wBAAwB,CAC7C,MAAO,0CAA0C,CACjD,MAAO,CAAAC,YAAY,KAAM,oBAAoB,CAC7C,MAAO,CAAAC,QAAQ,KAAM,gBAAgB,CAIrC,MAAO,CAAAC,OAAO,KAAM,4GAA4G,CAChI,MAAO,CAAAC,KAAK,KAAM,aAAa,CAC/B,MAAO,CAAAC,MAAM,KAAM,4EAA4E,CAC/F,MAAO,CAAAC,MAAM,KAAM,oBAAoB,QAAAC,GAAA,IAAAC,IAAA,gCAAAjB,QAAA,IAAAkB,SAAA,gCAAAC,IAAA,IAAAC,KAAA,yBAEvC,cAAe,SAAS,CAAAC,QAAQA,CAAA,CAAG,CACjC,KAAM,CAACC,QAAQ,CAAEC,WAAW,CAAC,CAAGtB,QAAQ,CAAC,IAAI,CAAC,CAC9C,KAAM,CAACuB,OAAO,CAAEC,UAAU,CAAC,CAAGxB,QAAQ,CAAC,IAAI,CAAC,CAC5C,KAAM,CAACyB,aAAa,CAAEC,aAAa,CAAC,CAAG1B,QAAQ,CAAC,IAAI,CAAC,CACrD,KAAM,CAAC2B,IAAI,CAAEC,OAAO,CAAC,CAAG5B,QAAQ,CAAC,EAAE,CAAC,CAEpC,KAAM,CAAA6B,YAAY,CAAG,GAAI,CAAAC,eAAe,CAACC,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAChE,KAAM,CAAAC,OAAO,CAAGL,YAAY,CAACM,GAAG,CAAC,MAAM,CAAC,CACxC,KAAM,CAAAC,WAAW,CAAGC,IAAI,CAACC,KAAK,CAACC,kBAAkB,CAACL,OAAO,CAAC,CAAC,CAE3D,KAAM,CAACM,iBAAiB,CAAEC,oBAAoB,CAAC,CAAGzC,QAAQ,CAAC,IAAI,CAAC,CAChE,KAAM,CAAA0C,QAAQ,CAAG7C,WAAW,CAAC,CAAC,CAE9BI,SAAS,CAAC,IAAM,CACZ,KAAM,CAAA0C,MAAM,IAAAC,MAAA,CAAMC,OAAO,CAACC,GAAG,CAACC,sBAAsB,oBAAkB,CAEtEC,KAAK,CAACL,MAAM,CAAC,CACRM,IAAI,CAAEC,QAAQ,EAAK,CAChB,GAAI,CAACA,QAAQ,CAACC,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,gBAAgB,CAAC,CACrC,CACA,MAAO,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAC1B,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,EAAK,CACZ5B,aAAa,CAAC4B,IAAI,CAAC,CACvB,CAAC,CAAC,CACDC,KAAK,CAAEC,KAAK,EAAK,CACdC,OAAO,CAACD,KAAK,CAAC,YAAY,CAAEA,KAAK,CAAC,CACtC,CAAC,CAAC,CACV,CAAC,CAAE,EAAE,CAAC,CAENvD,SAAS,CAAC,IAAM,CACZ,GAAIwB,aAAa,CAAE,CACf,KAAM,CAAAiC,YAAY,CAAGjC,aAAa,CAACkC,GAAG,CAAEC,QAAQ,GAAM,CAClDC,EAAE,CAAED,QAAQ,CAACC,EAAE,CACfC,IAAI,CAAEF,QAAQ,CAACE,IAAI,CACnBC,OAAO,CAAEA,CAAA,GAAMC,mBAAmB,CAACJ,QAAQ,CAACC,EAAE,CAAC,CAC/CI,OAAO,CAAEL,QAAQ,CAACC,EAAE,GAAKrB,iBAC7B,CAAC,CAAC,CAAC,CACHZ,OAAO,CAAC8B,YAAY,CAAC,CACzB,CACJ,CAAC,CAAE,CAACjC,aAAa,CAAEe,iBAAiB,CAAC,CAAC,CAGtC;AACA,KAAM,CAAAwB,mBAAmB,CAAIE,UAAU,EAAK,CACxC,KAAM,CAAAC,WAAW,CAAGD,UAAU,EAAI,IAAI,CAAGA,UAAU,CAAG,EAAE,CAAE;AAC1DxB,QAAQ,mBAAAE,MAAA,CAAmBwB,kBAAkB,CAAC/B,IAAI,CAACgC,SAAS,CAAC,CAAEF,WAAY,CAAC,CAAC,CAAC,CAAE,CAAC,CACjFG,aAAa,CAACJ,UAAU,CAAC,CACzBzB,oBAAoB,CAACyB,UAAU,CAAC,CACpC,CAAC,CAEH;AACA,KAAM,CAAAI,aAAa,CAAIJ,UAAU,EAAK,CACtC,KAAM,CAAAvB,MAAM,CAAGuB,UAAU,IAAAtB,MAAA,CAClBC,OAAO,CAACC,GAAG,CAACC,sBAAsB,gCAAAH,MAAA,CAA8BsB,UAAU,EAC7ErB,OAAO,CAACC,GAAG,CAACC,sBAAsB,CAAG,gBAAgB,CAEzDC,KAAK,CAACL,MAAM,CAAC,CACVM,IAAI,CAAEC,QAAQ,EAAK,CAChB,GAAI,CAACA,QAAQ,CAACC,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,6BAA6B,CAAC,CAClD,CACA,MAAO,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAC1B,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,EAAK,CACZhC,WAAW,CAACgC,IAAI,CAACiB,OAAO,CAAC,CACzB/C,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACD+B,KAAK,CAAEC,KAAK,EAAK,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/ChC,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACJ,CAAC,CAGCvB,SAAS,CAAC,IAAM,CACd,KAAM,CAAA0C,MAAM,CAAGP,WAAW,EAAI,IAAI,CAEhCA,WAAW,CAAC+B,WAAW,IAAAvB,MAAA,CAAMC,OAAO,CAACC,GAAG,CAACC,sBAAsB,gCAAAH,MAAA,CAA8BR,WAAW,CAAC+B,WAAW,KAAAvB,MAAA,CAC/GC,OAAO,CAACC,GAAG,CAACC,sBAAsB,gCAAAH,MAAA,CAA8BR,WAAW,CAACoC,kBAAkB,CAAE,CACjG3B,OAAO,CAACC,GAAG,CAACC,sBAAsB,CAAG,gBAAgB,CAG3DC,KAAK,CAACL,MAAM,CAAC,CACRM,IAAI,CAAEC,QAAQ,EAAK,CAChB,GAAI,CAACA,QAAQ,CAACC,EAAE,CAAE,CACd,KAAM,IAAI,CAAAC,KAAK,CAAC,6BAA6B,CAAC,CAClD,CACA,MAAO,CAAAF,QAAQ,CAACG,IAAI,CAAC,CAAC,CAC1B,CAAC,CAAC,CACDJ,IAAI,CAAEK,IAAI,EAAK,CACZhC,WAAW,CAACgC,IAAI,CAAC,CACjB9B,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACD+B,KAAK,CAAEC,KAAK,EAAK,CACdC,OAAO,CAACD,KAAK,CAAC,yBAAyB,CAAEA,KAAK,CAAC,CAC/ChC,UAAU,CAAC,KAAK,CAAC,CACrB,CAAC,CAAC,CACR,CAAC,CAAE,CAACO,MAAM,CAACC,QAAQ,CAACC,MAAM,CAAC,CAAC,CAC5B,mBACEd,KAAA,CAAAF,SAAA,EAAAwD,QAAA,eAEAzD,IAAA,CAACF,MAAM,GAAE,CAAC,cACVE,IAAA,CAACrB,MAAM,EAAA8E,QAAA,cACHzD,IAAA,CAACpB,KAAK,EAAC8E,OAAO,cAAE1D,IAAA,CAACL,OAAO,GAAE,CAAE,CAAA8D,QAAA,cAC1BzD,IAAA,CAACpB,KAAK,EAAC+E,KAAK,MAACD,OAAO,CAAE,cACpB1D,IAAA,CAACP,YAAY,EAAC2B,WAAW,CAAEA,WAAY,CAACT,IAAI,CAAEA,IAAK,CAAC,CAAC,cACrDX,IAAA,CAACN,QAAQ,EAACW,QAAQ,CAAEA,QAAS,CAAE,CAAC,CACjC,CAAC,CAAC,CACG,CAAC,CACL,CAAC,cACTL,IAAA,CAACH,MAAM,GAAE,CAAC,EAER,CAAC,CAEP"},"metadata":{},"sourceType":"module","externalDependencies":[]}